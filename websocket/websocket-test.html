<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>WebSocket STOMP í…ŒìŠ¤íŠ¸</title>
  <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
</head>
<body>
  <h2>ğŸ“¡ ì‹¤ì‹œê°„ í”Œëœ í…ŒìŠ¤íŠ¸</h2>
  <button onclick="sendUpdate()">í”Œëœ ì—…ë°ì´íŠ¸</button>
  <button onclick="timeTableCreate()">ì‹œê°„í‘œ ìƒì„±</button>
  <button onclick="timeTableBlockCreate()">ì‹œê°„í‘œ ë¸”ë¡ ìƒì„±</button>

  <script>
    const socket = new SockJS("http://localhost:8080/ws-plan"); // ë„ˆì˜ ì„œë²„ ì£¼ì†Œ
    const stompClient = Stomp.over(socket);

    stompClient.connect({}, function (frame) {
      console.log("âœ… WebSocket ì—°ê²° ì™„ë£Œ:", frame);

      stompClient.subscribe("/topic/plan/2/update/plan", function (message) {
        console.log("ğŸ“© ìˆ˜ì‹ ëœ ë©”ì‹œì§€:", message.body);
        alert("ìˆ˜ì‹ ëœ ë©”ì‹œì§€: " + message.body);
      });
      stompClient.subscribe("/topic/plan/2/create/timetable", function (message) {
        console.log("ğŸ“© ìˆ˜ì‹ ëœ ë©”ì‹œì§€:", message.body);
        alert("ìˆ˜ì‹ ëœ ë©”ì‹œì§€: " + message.body);
      });
      stompClient.subscribe("/topic/plan/2/create/timetableBlock", function (message) {
        console.log("ğŸ“© ìˆ˜ì‹ ëœ ë©”ì‹œì§€:", message.body);
        alert("ìˆ˜ì‹ ëœ ë©”ì‹œì§€: " + message.body);
      });

    });

    function sendUpdate() {
      const planData = {
        planName: "new plan",
      };
      stompClient.send("/app/plan/2/update/plan", {}, JSON.stringify(planData));
      console.log("ğŸš€ ë©”ì‹œì§€ ì „ì†¡:", planData);
    }

    function timeTableCreate() {
      const timeTableData = {
        timetableVO: {
          date: "2023-10-01",
          startTime: "10:00:00",
          endTime: "22:00:00",
        }
      };
      stompClient.send("/app/plan/2/create/timetable", {}, JSON.stringify(timeTableData));
      console.log("ğŸš€ ì‹œê°„í‘œ ìƒì„± ë©”ì‹œì§€ ì „ì†¡:", timeTableData);
    }

    function timeTableBlockCreate() {
      const timeTableBlockData = {
        timeTableId: 1,
        blockName: "new block",
      };
      stompClient.send("/app/plan/2/create/timttableBlock", {}, JSON.stringify(timeTableBlockData));
      console.log("ğŸš€ ì‹œê°„í‘œ ë¸”ë¡ ìƒì„± ë©”ì‹œì§€ ì „ì†¡:", timeTableBlockData);
    }
  </script>
</body>
</html>
